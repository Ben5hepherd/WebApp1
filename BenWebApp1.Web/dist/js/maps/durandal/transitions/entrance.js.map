{"version":3,"sources":["durandal/transitions/entrance.js"],"names":["define","system","composition","$","removeAnimationClasses","ele","fadeOnly","classList","remove","fadeOutDuration","endValues","left","opacity","clearValues","top","right","bottom","position","isIE","navigator","userAgent","match","animation","domPrefixes","split","elm","document","createElement","undefined","style","animationName","i","length","log","entrance","context","defer","dfd","endTransition","resolve","scrollIfNeeded","keepScrollPosition","scrollTop","startTransition","triggerAttach","child","add","setTimeout","activeView","$child","css","duration","animate","easing","always","startValues","display","fadeOut","promise"],"mappings":"AAYAA,QAAQ,kBAAmB,uBAAwB,UAAW,SAASC,EAAQC,EAAaC,GA4CxF,QAASC,GAAuBC,EAAKC,GACjCD,EAAIE,UAAUC,OAAOF,EAAW,mBAAqB,eACrDD,EAAIE,UAAUC,OAAO,gBA7CzB,GAAIC,GAAkB,IAClBC,GACAC,KAAM,MACNC,QAAS,GAETC,GACAF,KAAM,GACNG,IAAK,GACLC,MAAO,GACPC,OAAO,GACPC,SAAS,GACTL,QAAS,IAGTM,EAAOC,UAAUC,UAAUC,MAAM,YAAcF,UAAUC,UAAUC,MAAM,QAEzEC,GAAY,EACZC,EAAc,wBAAwBC,MAAM,KAC5CC,EAAMC,SAASC,cAAc,MAMjC,IAJ+BC,SAA5BH,EAAII,MAAMC,gBACTR,GAAY,IAGZA,EACA,IAAI,GAAIS,GAAI,EAAGA,EAAIR,EAAYS,OAAQD,IACnC,GAAmDH,SAAhDH,EAAII,MAAMN,EAAYQ,GAAK,iBAAgC,CAC1DT,GAAY,CACZ,OAKTA,EACIJ,EACCjB,EAAOgC,IAAI,uCAEXhC,EAAOgC,IAAI,0BAGfhC,EAAOgC,IAAI,2BAYf,IAAIC,GAAW,SAASC,GACpB,MAAOlC,GAAOmC,MAAM,SAASC,GACzB,QAASC,KACLD,EAAIE,UAGR,QAASC,KACAL,EAAQM,oBACTtC,EAAEuB,UAAUgB,UAAU,GAoB1B,QAASC,KACLH,IACAL,EAAQS,gBAEJtB,GACAlB,EAAuB+B,EAAQU,MAAOvC,GACtC6B,EAAQU,MAAMtC,UAAUuC,IAAIxC,EAAW,mBAAqB,eAC5DyC,WAAW,WACP3C,EAAuB+B,EAAQU,MAAOvC,GACnC6B,EAAQa,YACP5C,EAAuB+B,EAAQa,WAAY1C,GAE/C2C,EAAOC,IAAIrC,GACXyB,KACDa,IAEHF,EAAOG,QAAQ1C,GACXyC,SAAUA,EACVE,OAAQ,QACRC,OAAQ,WACJL,EAAOC,IAAIrC,GACXyB,OArCpB,GAAKH,EAAQU,MAEN,CACH,GAAIM,GAAWhB,EAAQgB,UAAY,IAC/BF,EAAS9C,EAAEgC,EAAQU,OACnBvC,IAAa6B,EAAQ7B,SACrBiD,GACAC,QAAS,QACT5C,QAAS,EACTK,SAAU,WACVN,KAAML,GAAYgB,EAAY,MAAQ,OACtCP,MAAO,EACPD,IAAK,EACLE,OAAQ,EA8BZiC,GAAOC,IAAIK,GAERpB,EAAQa,WACH1B,IAAcJ,GACdd,EAAuB+B,EAAQa,WAAY1C,GAC3C6B,EAAQa,WAAWzC,UAAUuC,IAAI,gBACjCC,WAAWJ,EAAiBlC,IAE5BN,EAAEgC,EAAQa,YAAYS,SAAUN,SAAU1C,EAAiB6C,OAAQX,IAGvEA,QArDJxC,GAAEgC,EAAQa,YAAYS,QAAQhD,EAAiB6B,KAwDpDoB,UAGP,OAAOxB","file":"../../../durandal/transitions/entrance.js","sourcesContent":["/**\r\n * Durandal 2.2.0 Copyright (c) 2010-2016 Blue Spire Consulting, Inc. All Rights Reserved.\r\n * Available via the MIT license.\r\n * see: http://durandaljs.com or https://github.com/BlueSpire/Durandal for details.\r\n */\r\n/**\r\n * The entrance transition module.\r\n * @module entrance\r\n * @requires system\r\n * @requires composition\r\n * @requires jquery\r\n */\r\ndefine(['durandal/system', 'durandal/composition', 'jquery'], function(system, composition, $) {\r\n    var fadeOutDuration = 100;\r\n    var endValues = {\r\n        left: '0px',\r\n        opacity: 1\r\n    };\r\n    var clearValues = {\r\n        left: '',\r\n        top: '',\r\n        right: '',\r\n        bottom:'',\r\n        position:'',\r\n        opacity: ''\r\n    };\r\n\r\n    var isIE = navigator.userAgent.match(/Trident/) || navigator.userAgent.match(/MSIE/);\r\n\r\n    var animation = false,\r\n        domPrefixes = 'Webkit Moz O ms Khtml'.split(' '),\r\n        elm = document.createElement('div');\r\n\r\n    if(elm.style.animationName !== undefined) {\r\n        animation = true;\r\n    }\r\n\r\n    if(!animation) {\r\n        for(var i = 0; i < domPrefixes.length; i++) {\r\n            if(elm.style[domPrefixes[i] + 'AnimationName'] !== undefined) {\r\n                animation = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    if(animation) {\r\n        if(isIE){\r\n            system.log('Using CSS3/jQuery mixed animations.');\r\n        }else{\r\n            system.log('Using CSS3 animations.');\r\n        }\r\n    } else {\r\n        system.log('Using jQuery animations.');\r\n    }\r\n\r\n    function removeAnimationClasses(ele, fadeOnly){\r\n        ele.classList.remove(fadeOnly ? 'entrance-in-fade' : 'entrance-in');\r\n        ele.classList.remove('entrance-out');\r\n    }\r\n\r\n    /**\r\n     * @class EntranceModule\r\n     * @constructor\r\n     */\r\n    var entrance = function(context) {\r\n        return system.defer(function(dfd) {\r\n            function endTransition() {\r\n                dfd.resolve();\r\n            }\r\n\r\n            function scrollIfNeeded() {\r\n                if (!context.keepScrollPosition) {\r\n                    $(document).scrollTop(0);\r\n                }\r\n            }\r\n\r\n            if (!context.child) {\r\n                $(context.activeView).fadeOut(fadeOutDuration, endTransition);\r\n            } else {\r\n                var duration = context.duration || 500;\r\n                var $child = $(context.child);\r\n                var fadeOnly = !!context.fadeOnly;\r\n                var startValues = {\r\n                    display: 'block',\r\n                    opacity: 0,\r\n                    position: 'absolute',\r\n                    left: fadeOnly || animation ? '0px' : '20px',\r\n                    right: 0,\r\n                    top: 0,\r\n                    bottom: 0\r\n                };\r\n\r\n                function startTransition() {\r\n                    scrollIfNeeded();\r\n                    context.triggerAttach();\r\n\r\n                    if (animation) {\r\n                        removeAnimationClasses(context.child, fadeOnly);\r\n                        context.child.classList.add(fadeOnly ? 'entrance-in-fade' : 'entrance-in');\r\n                        setTimeout(function () {\r\n                            removeAnimationClasses(context.child, fadeOnly);\r\n                            if(context.activeView){\r\n                                removeAnimationClasses(context.activeView, fadeOnly);\r\n                            }\r\n                            $child.css(clearValues);\r\n                            endTransition();\r\n                        }, duration);\r\n                    } else {\r\n                        $child.animate(endValues, {\r\n                            duration: duration,\r\n                            easing: 'swing',\r\n                            always: function() {\r\n                                $child.css(clearValues);\r\n                                endTransition();\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n                $child.css(startValues);\r\n\r\n                if(context.activeView) {\r\n                    if (animation && !isIE) {\r\n                        removeAnimationClasses(context.activeView, fadeOnly);\r\n                        context.activeView.classList.add('entrance-out');\r\n                        setTimeout(startTransition, fadeOutDuration);\r\n                    } else {\r\n                        $(context.activeView).fadeOut({ duration: fadeOutDuration, always: startTransition });\r\n                    }\r\n                } else {\r\n                    startTransition();\r\n                }\r\n            }\r\n        }).promise();\r\n    };\r\n\r\n    return entrance;\r\n});\r\n"]}